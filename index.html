<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <meta name="theme-color" content="#0f172a"/>
  <link rel="manifest" href="manifest.json"/>
  <link rel="apple-touch-icon" href="icons/icon-192.png"/>
  <title>Macro Tracker</title>
  <style>
    :root{--bg:#0b1220;--card:#0f172a;--muted:#94a3b8;--text:#e2e8f0;--good:#10b981;--warn:#f59e0b;--bad:#ef4444;--line:#1f2a44;--chip:#111c33;}
    *{box-sizing:border-box}
    body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;background:var(--bg);color:var(--text);}
    header{position:sticky;top:0;z-index:10;background:rgba(11,18,32,.9);backdrop-filter:blur(10px);padding:14px 16px;border-bottom:1px solid var(--line);}
    header h1{margin:0;font-size:18px;letter-spacing:.3px}
    header .sub{margin-top:6px;color:var(--muted);font-size:12px;display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    main{padding:14px 14px 90px;max-width:900px;margin:0 auto;}
    .grid{display:grid;gap:12px}
    .card{background:var(--card);border:1px solid var(--line);border-radius:14px;padding:12px}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    label{font-size:12px;color:var(--muted);display:block;margin-bottom:6px}
    input,select,button,textarea{font:inherit}
    input,select,textarea{width:100%;padding:10px 10px;border-radius:12px;border:1px solid var(--line);background:#0b1530;color:var(--text);}
    textarea{min-height:66px;resize:vertical}
    .btn{padding:10px 12px;border-radius:12px;border:1px solid var(--line);background:#122044;color:var(--text);font-weight:600}
    .btn.primary{background:#1d4ed8;border-color:#1d4ed8}
    .btn.good{background:#065f46;border-color:#065f46}
    .btn.bad{background:#7f1d1d;border-color:#7f1d1d}
    .btn:active{transform:scale(.99)}
    .pill{background:var(--chip);border:1px solid var(--line);padding:6px 10px;border-radius:999px;font-size:12px;color:var(--muted)}
    .split{display:grid;grid-template-columns:1fr;gap:12px}
    @media(min-width:860px){.split{grid-template-columns:1.15fr .85fr}}
    .table{width:100%;border-collapse:collapse}
    .table th,.table td{padding:10px 8px;border-bottom:1px solid var(--line);font-size:13px;text-align:left}
    .table th{color:var(--muted);font-weight:600}
    .kpi{display:flex;justify-content:space-between;gap:10px}
    .kpi strong{font-size:14px}
    .kpi span{color:var(--muted);font-size:12px}
    .bars{display:grid;gap:10px}
    .bar{background:#0b1530;border:1px solid var(--line);border-radius:12px;padding:10px}
    .bar .top{display:flex;justify-content:space-between;align-items:baseline}
    .bar .top b{font-size:13px}
    .bar .top small{color:var(--muted)}
    .meter{height:10px;background:#0a1022;border-radius:999px;overflow:hidden;margin-top:8px;border:1px solid #0f1b35}
    .fill{height:100%}
    .note{color:var(--muted);font-size:12px;line-height:1.4}
    nav{position:fixed;bottom:0;left:0;right:0;background:rgba(11,18,32,.92);backdrop-filter:blur(10px);border-top:1px solid var(--line);padding:10px 14px;display:flex;gap:10px;justify-content:space-between;align-items:center}
    .navbtn{flex:1;text-align:center}
    .hide{display:none !important}
    .warnText{color:var(--warn);font-weight:700}
    .badText{color:var(--bad);font-weight:700}
    .goodText{color:var(--good);font-weight:700}
  </style>
</head>
<body>
<header>
  <h1>Macro Tracker</h1>
  <div class="sub">
    <span class="pill" id="statusPill">Offline-ready</span>
    <span class="pill" id="dayPill">Day: —</span>
    <span class="pill" id="datePill">Date: —</span>
  </div>
</header>

<main class="grid">
  <section class="card split">
    <div>
      <div class="row">
        <div style="flex:1;min-width:160px">
          <label for="logDate">Date</label>
          <input id="logDate" type="date"/>
        </div>
        <div style="flex:1;min-width:120px">
          <label for="dayNum">Day #</label>
          <input id="dayNum" inputmode="numeric" placeholder="18"/>
        </div>
        <div style="flex:1;min-width:140px">
          <label for="mealType">Meal/Snack</label>
          <select id="mealType">
            <option>Meal</option>
            <option>Snack</option>
          </select>
        </div>
        <div style="flex:1;min-width:120px">
          <label for="entryNum">Entry #</label>
          <input id="entryNum" inputmode="numeric" placeholder="1"/>
        </div>
      </div>

      <div class="row" style="margin-top:10px">
        <div style="flex:2;min-width:220px">
          <label for="foodName">Food name</label>
          <input id="foodName" placeholder="e.g., Egg White Grill x2"/>
        </div>
        <div style="flex:1;min-width:120px">
          <label for="qty">Qty</label>
          <input id="qty" inputmode="decimal" placeholder="1" value="1"/>
        </div>
        <div style="flex:1;min-width:140px">
          <label for="unit">Unit</label>
          <input id="unit" placeholder="serving"/>
        </div>
      </div>

      <div class="row" style="margin-top:10px">
        <div style="flex:1;min-width:120px"><label>Calories</label><input id="cal" inputmode="decimal" placeholder="0"/></div>
        <div style="flex:1;min-width:120px"><label>Protein (g)</label><input id="pro" inputmode="decimal" placeholder="0"/></div>
        <div style="flex:1;min-width:120px"><label>Carbs (g)</label><input id="carb" inputmode="decimal" placeholder="0"/></div>
        <div style="flex:1;min-width:120px"><label>Fat (g)</label><input id="fat" inputmode="decimal" placeholder="0"/></div>
      </div>

      <div class="row" style="margin-top:10px">
        <div style="flex:1;min-width:150px"><label>Fiber (g)</label><input id="fiber" inputmode="decimal" placeholder="0"/></div>
        <div style="flex:1;min-width:160px"><label>Soluble Fiber (g)</label><input id="solFiber" inputmode="decimal" placeholder="0"/></div>
        <div style="flex:1;min-width:160px"><label>Sat Fat (g)</label><input id="satFat" inputmode="decimal" placeholder="0"/></div>
      </div>

      <div class="row" style="margin-top:10px">
        <div style="flex:1;min-width:220px">
          <label for="link">Link (photo/receipt) – optional</label>
          <input id="link" placeholder="paste link"/>
        </div>
      </div>

      <div class="row" style="margin-top:10px">
        <div style="flex:2;min-width:220px">
          <label for="notes">Notes</label>
          <textarea id="notes" placeholder="e.g., no cheese, half broth, etc."></textarea>
        </div>
      </div>

      <div class="row" style="margin-top:10px">
        <button class="btn primary" id="addBtn">Add entry</button>
        <button class="btn" id="scanBtn">Scan barcode (optional)</button>
        <button class="btn" id="exportBtn">Export CSV</button>
        <button class="btn bad" id="resetBtn">Reset day</button>
      </div>
      <p class="note" id="scanNote">Barcode scanning uses your iPhone camera. Offline it can capture the barcode for later.</p>
    </div>

    <div>
      <div class="card" style="padding:12px;margin:0">
        <div class="kpi"><strong>Daily totals • Goals • Remaining</strong><span id="totalsSub">—</span></div>
        <div class="bars" id="bars"></div>
        <p class="note" id="alerts"></p>
      </div>
    </div>
  </section>

  <section class="card">
    <div class="row" style="justify-content:space-between;align-items:flex-end">
      <div class="kpi"><strong>Entries for selected date</strong><span class="note">Tap an entry to edit/delete</span></div>
      <div class="row" style="gap:8px">
        <button class="btn" id="prevDayBtn">◀</button>
        <button class="btn" id="todayBtn">Today</button>
        <button class="btn" id="nextDayBtn">▶</button>
      </div>
    </div>
    <div style="overflow:auto;margin-top:8px">
      <table class="table" id="entryTable">
        <thead>
          <tr>
            <th>Time</th><th>Meal</th><th>Food</th><th>Cals</th><th>P</th><th>C</th><th>F</th><th>Fiber</th><th>Sol</th><th>Sat</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </section>
</main>

<nav>
  <button class="btn navbtn" id="goalsBtn">Goals</button>
  <button class="btn navbtn good" id="saveGoalsBtn">Save</button>
</nav>

<div id="goalsModal" class="hide" style="position:fixed;inset:0;background:rgba(0,0,0,.55);backdrop-filter:blur(6px);display:flex;align-items:flex-end;justify-content:center;padding:12px">
  <div style="width:min(720px,100%);background:var(--card);border:1px solid var(--line);border-radius:16px;padding:14px">
    <div class="row" style="justify-content:space-between;align-items:center">
      <strong style="font-size:14px">Daily goals</strong>
      <button class="btn" id="closeGoalsBtn">Close</button>
    </div>
    <div class="row" style="margin-top:10px">
      <div style="flex:1;min-width:140px"><label>Calories</label><input id="gCal" inputmode="decimal"></div>
      <div style="flex:1;min-width:140px"><label>Protein (g)</label><input id="gPro" inputmode="decimal"></div>
      <div style="flex:1;min-width:140px"><label>Carbs (g)</label><input id="gCarb" inputmode="decimal"></div>
      <div style="flex:1;min-width:140px"><label>Fat (g)</label><input id="gFat" inputmode="decimal"></div>
    </div>
    <div class="row" style="margin-top:10px">
      <div style="flex:1;min-width:160px"><label>Fiber (g)</label><input id="gFiber" inputmode="decimal"></div>
      <div style="flex:1;min-width:180px"><label>Soluble Fiber (g)</label><input id="gSolFiber" inputmode="decimal"></div>
      <div style="flex:1;min-width:180px"><label>Sat Fat max (g)</label><input id="gSatFat" inputmode="decimal"></div>
    </div>
    <p class="note" style="margin-top:10px">Dashboard always shows <b>Daily totals</b>, <b>Goals</b>, and <b>Remaining</b>.</p>
  </div>
</div>

<script src="app.js"></script>
</body>
</html>
